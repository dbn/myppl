define(["jquery","underscore","backbone","model/city","model/artists"],function(a,b,c,d,e){var f=c.Collection.extend({model:d,url:"data/citydata.html",tmpCities:[],initialize:function(){b.bindAll(this),this.artistCollection=new e;var a=this;this.artistCollection.fetch()},joinArtists:function(a){if(a.length==0||this.artistCollection.length==0)return;for(var b=0;b<a.length;b++){var c=a[b],d=this.artistCollection.filter(function(a){return a.get("city").toLowerCase()==c.name.toLowerCase()});c.artists=d}return a},parse:function(a,b){return this.joinArtists(a)},findArtist:function(a){return this.artistCollection.find(function(b){return b.get("name").toLowerCase()==a.toLowerCase()})}});return new f})